# sarsfx
Основанный на FoldX пайплайн поиска мутаций, повышающих афинность S-белка SARS-Cov-2 к ACE2 

# Установка
__cd /путь_к_директории_проекта__

__git clone https://github.com/ovavulov/sarsfx__

# Применение
Настройка окружения

__pip install -r requirements.txt__

Cделать коррекцию структуры комплекса с помощью команды RepairPDB:

__python Repair.py -f config.cfg__

Сделать скрининг мутаций по заданным позициям (PositionScan, BuildModel, AnalyseComplex)

__python Screening.py -f config.cfg__

Результаты работы пайплайна содержатся в папке __reports__

Параметры поиска задаются через конфиг-файл (\*.cfg) вида

        complex=6lzg.pdb
        rbd=RBD.pdb
        positions=NB487h,SB477h,VB503p,TB500p,FB456p,YB489p
        posRange=2:6
        mutTake=all
        nthreads=12
        repair=done
        posscan=todo
        bmRBD=todo
        bmComplex=todo
        analyseComplex=todo
        rs=19

Описание параметров:

__complex__ - имя файла для структуры комплекса RBD и ACE2 (до Repair)

__rbd__ - имя файла для структуры RBD (после Repair)

__positions__ - перечень позиций в составе RBD для скрининга. Подаётся в формате параметра positions для комманды PositionScan в FoldX. Ключ d (24 аминокислоты) пока не поддерживается

__posRange__ {int:int} - диапазон размера целевых мутаций по количеству мутировавших позиций. Например, posRange=2:3 означает, что мы будем проверять только такие наборы мутаций, в которых заменка остатков произошла на двух или трёх позициях

__mutTake__ {float, int, "input", "all"} - так как потенциально число комбинаций подходящих мутаций может быть очень велико, мы можем ограничить выборку для конечного анализа с помощью _mutTake_. Если подается десятичная дробь от 0 до 1, то случайным образом отбирается соответствующая доля от общего числа мутаций. Если подается натуральное число, то случайно выбирается фиксированное число мутаций. С параметром "input" пользователь задает параметр вручную (float или int) по походу работы пайплайна. При установке "all" анализируются все комбинации мутаций

__nthreads__ {int} - количество параллельных потоков исполнения пайплайна

__repair__ {"todo", "done"} - флаг выполнения коррекции структуры. Значение "todo" блокирует проведение скрининга

__posscan__, __bmRBD__, __bmComplex__, __analyseComplex__ {"todo", "done", "skip"} - флаги статуса соответствующих этапов пайплайна для раздельного выполнения этапов. Если требуется выполнить некоторый этап отдельно, необходимо чтобы у предыдущих этапов был выставлен флаг "done", а у последующих - "skip" (пропуск этапа)

__rs__ {int} - параметр воспроизводимости распределения промежуточных результатов по каталогу проекта, не влияет на результат работы пайплайна
 

# Описание пайплайна

1. Коррекция структуры комплекса с помощью RepairRBD

2. Запуск PositionScan по указанным позициям с предварительным отбором __только SNP__ на основе данных о нуклеотидной последовательности RBD. Составление наборов мутаций по заданным параметрам

3. Внесение полученных наборов мутаций в структуру RBD, исключение дестабилизирующих S-белок комбинаций

4. Внесение полученных наборов мутаций в структуру комплекса RBD+ACE2

5. Запуск AnalyseComplex на полученных мутантных комплексах, а также на исходной скорректированной структуре комплекса. Сохранение результатов

